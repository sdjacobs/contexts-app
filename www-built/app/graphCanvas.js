function graphCanvas(){function h(){h.started=!0,n.clearRect(0,0,r.width,r.height);var i=f.scale(),u=f.translate();n.beginPath(),n.strokeStyle="lightgrey",t.forEach(function(e){n.moveTo(i*e.source.x+u[0],i*e.source.y+u[1]),n.lineTo(i*e.target.x+u[0],i*e.target.y+u[1])}),n.stroke(),e.forEach(function(e){n.beginPath(),n.arc(i*e.x+u[0],i*e.y+u[1],i*(e.size||8),0,2*Math.PI),n.fillStyle=e.color,n.fill()}),o&&(n.font=(i*10).toString()+"pt Arial",n.fillStyle="black",e.forEach(function(e){n.fillText(e.label,i*(e.x+8)+u[0],i*e.y+u[1])})),s.alpha()&&window.requestAnimationFrame(h)}function p(e){return+e>0?"_"+e:e.replace("'","_apos_")}function d(e){return d3.select("#"+p(e))}var e=undefined,t=undefined,n=undefined,r=undefined,i=[],s=undefined,o=!1,u=0,a=0,f=d3.behavior.zoom(),l=function(){function n(){var n=t[e];return e=(e+1)%t.length,n}var e=0,t=["red","orange","yellow","green","brown","purple"];return n}(),c=function(e){return u=parseInt(e.style("width")),a=parseInt(e.style("height")),r=e.append("canvas").attr("width",u).attr("height",a).attr("pointer-events","all").call(f).node(),n=r.getContext("2d"),s||(s=d3.layout.force().gravity(.05).distance(100).charge(-100).size([u,a])),c};return c.start=function(){return s.nodes(e).links(t).on("end",function(){f.on("zoom",h)}).on("start",function(){f.on("zoom",undefined)}).start(),window.requestAnimationFrame(h),c},c.stop=function(){return s.alpha(0),c},c.center=function(){f.scale(.25),f.translate([u/4,a/4]),h()},c.selectNode=function(n,r,o){function c(r,i,s){if(i==0)return;r.neighbors||(r.neighbors=findNeighbors(e,t,r)),r.neighbors.forEach(function(e){e!=n&&(e.color=s,c(e,i-1,s))})}i.push(n),n.color=d3.hsl(o||l()),n.selectedGens=r,c(n,r,n.color.brighter(1.2)),f.scale(1),f.translate([u/2-n.x,a/2-n.y]),s.alpha()||h()},c.unSelectNode=function(e){function t(e,n){e.color=e.oldcolor,n>0&&e.neighbors.forEach(function(e){t(e,n-1)})}t(e,e.selectedGens);var n=i.findIndex(function(t){return t==e});n>=0&&i.splice(n,1),s.alpha()||h()},c.nodes=function(t){return arguments.length?(e=t,e.forEach(function(e){e.color||(e.color="black"),e.oldcolor=e.color}),c):e},c.edges=function(e){return arguments.length?(t=e,c):t},c.selectedNodes=function(e){return arguments.length?(i=e,c):i},c.labels=function(e){return arguments.length?(o=e,h.started&&h(),c):o},c.redraw=function(){if(!s)return;if(s.alpha())return;h()},c.force=function(e){return arguments.length?(s=e,c):s},c}function findNeighbors(e,t,n){var r=t.filter(function(e){return e.source==n}).map(function(e){return e.target}),s=t.filter(function(e){return e.target==n}).map(function(e){return e.source}),o=r;for(i in s)!s[i]in o&&o.push(s[i]);return o}define(["d3"],function(e){return graphCanvas});